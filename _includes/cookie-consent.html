<!-- Cookie Consent Banner -->
<div class="cookie-banner" id="cookieBanner">
    <div class="cookie-content">
        <div class="cookie-text">
            <p>We use cookies to improve your experience and analyze site usage. By clicking "Accept", you agree to our use of cookies. Learn more in our <a href="/cookies">Cookie Policy</a>.</p>
        </div>
        <div class="cookie-buttons">
            <button class="cookie-button reject" onclick="rejectCookies()">Reject All</button>
            <button class="cookie-button accept" onclick="acceptCookies()">Accept All</button>
        </div>
    </div>
</div>

<!-- Cookie Consent Script -->
<script>
    // Check if user has already made a cookie choice
    function checkCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            // Show banner if no choice has been made
            document.getElementById('cookieBanner').classList.add('show');
        } else if (consent === 'accepted') {
            // Enable analytics if previously accepted
            enableAnalytics();
        }
    }
    
    // Accept cookies
    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        localStorage.setItem('cookieConsentDate', new Date().toISOString());
        document.getElementById('cookieBanner').classList.remove('show');
        enableAnalytics();
    }
    
    // Reject cookies
    function rejectCookies() {
        localStorage.setItem('cookieConsent', 'rejected');
        localStorage.setItem('cookieConsentDate', new Date().toISOString());
        document.getElementById('cookieBanner').classList.remove('show');
        disableAnalytics();
    }
    
    // Enable analytics
    function enableAnalytics() {
        // Update consent state
        gtag('consent', 'update', {
            'analytics_storage': 'granted',
            'ad_storage': 'granted',
            'ad_user_data': 'granted',
            'ad_personalization': 'granted'
        });
        
        // Send custom event for tracking
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
            'event': 'cookieConsentUpdate',
            'consentStatus': 'accepted'
        });
    }
    
    // Disable analytics
    function disableAnalytics() {
        // Update consent state
        gtag('consent', 'update', {
            'analytics_storage': 'denied',
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied'
        });
        
        // Clear GA cookies
        document.cookie = '_ga=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        document.cookie = '_ga_6JWP8EQYNW=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        
        // Send custom event for tracking
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
            'event': 'cookieConsentUpdate',
            'consentStatus': 'rejected'
        });
    }
    
    // Define gtag function if not already defined
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    
    // Check consent on page load
    document.addEventListener('DOMContentLoaded', checkCookieConsent);
</script>